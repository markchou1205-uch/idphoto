:root { --sidebar-icon-width: 80px; --sidebar-panel-width: 340px; --primary-color: #0d6efd; }
body { background-color: #f8f9fa; font-family: 'Segoe UI', sans-serif; height: 100vh; overflow: hidden; }

/* Sidebars & Cards (不變) */
#sidebar-icons { width: var(--sidebar-icon-width); min-width: var(--sidebar-icon-width); z-index: 1020; }
.nav-item-icon { width: 100%; padding: 15px 0; cursor: pointer; color: rgba(255,255,255,0.5); transition: all 0.2s; }
.nav-item-icon:hover { color: white; background: rgba(255,255,255,0.1); }
.nav-item-icon.active { color: #fff; background: var(--primary-color); }
.nav-item-icon i { font-size: 1.6rem; display: block; margin-bottom: 4px; }
.nav-item-icon span { font-size: 11px; }
#sidebar-panels { width: var(--sidebar-panel-width); min-width: var(--sidebar-panel-width); z-index: 1010; background: #fff; box-shadow: 2px 0 5px rgba(0,0,0,0.05); }
.feature-card { cursor: pointer; transition: transform 0.3s, box-shadow 0.3s; }
.feature-card:hover { transform: translateY(-5px); box-shadow: 0 10px 20px rgba(0,0,0,0.1) !important; }
.icon-circle { width: 60px; height: 60px; border-radius: 50%; display: inline-flex; align-items: center; justify-content: center; font-size: 1.8rem; }
.spec-card { border: 1px solid #dee2e6; border-radius: 8px; padding: 10px 15px; cursor: pointer; transition: all 0.2s; background: white; display: flex; justify-content: space-between; align-items: center; }
.spec-card:hover { border-color: var(--primary-color); background: #f1f8ff; }
.spec-card.active { border-color: var(--primary-color); background: #e7f1ff; border-left: 4px solid var(--primary-color); }

/* --- Image Editor --- */

/* 1. 工作區 (Flex 置中) */
#workspace-area {
    display: flex !important;
    align-items: center; /* 垂直置中 */
    justify-content: center; /* 水平置中 */
    background-color: #212529; /* 深色背景讓紅框更明顯 */
    overflow: hidden; /* 防止捲軸出現 */
    position: relative;
}

/* 2. 容器 (視窗) */
.image-wrapper { 
    position: relative !important; 
    display: block; 
    /* 移除 margin: 0 auto，改由父層 Flex 控制 */
    background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" viewBox="0 0 10 10"><rect width="5" height="5" fill="%23eee"/><rect x="5" y="5" width="5" height="5" fill="%23eee"/></svg>');
    transform-origin: center center; /* 縮放基準改為中心 */
    box-shadow: 0 0 50px rgba(0,0,0,0.5);
    border: 2px solid rgba(255, 255, 255, 0.1);
}

/* 3. 圖片 */
.image-wrapper img { 
    display: block; 
    position: absolute; 
    top: 0; left: 0;
    max-width: none !important; 
    max-height: none !important;
    pointer-events: none; /* 讓滑鼠事件穿透給 wrapper 處理 */
}

/* 4. 遮罩 (紅框) */
.crop-mask { 
    position: absolute; 
    top: 0; left: 0;
    width: 100%; height: 100%;
    box-shadow: 0 0 0 9999px rgba(0, 0, 0, 0.8); /* 稍微調亮一點暗角，方便看周圍 */
    pointer-events: none; 
    z-index: 10; 
    border: 2px dashed #ff3333; 
}

/* 5. 標籤 */
.mask-label { 
    position: absolute; bottom: -40px; left: 50%; transform: translateX(-50%); 
    background: #ff3333; color: white; 
    padding: 4px 12px; border-radius: 20px; font-size: 14px; white-space: nowrap; font-weight: bold;
    box-shadow: 0 2px 5px rgba(0,0,0,0.3);
}

/* 6. 輔助線 (修正版：深藍粗線) */
.guide-line {
    position: absolute; left: 0; width: 100%;
    border-top: 2px solid #0056b3; /* 深藍色實線 */
    box-shadow: 0 1px 0 rgba(255,255,255,0.3); /* 下陰影增加對比 */
    pointer-events: none;
    text-align: right;
}
.guide-line span {
    background: #0056b3; color: white;
    font-size: 11px; padding: 2px 6px; border-radius: 0 0 0 4px;
    font-weight: bold;
}

/* 7. 縮放列 (修正版：Z-Index 提高) */
#zoom-toolbar {
    z-index: 100 !important; /* 確保蓋過遮罩 */
    background-color: rgba(255, 255, 255, 0.95) !important;
    box-shadow: 0 5px 15px rgba(0,0,0,0.2) !important;
    margin-bottom: 30px; /* 離底部稍微遠一點 */
}

/* Misc */
.result-btn { cursor: pointer; transition: 0.2s; background: #fff; }
.result-btn.active { border-color: var(--primary-color) !important; background: #e7f1ff; }
.loading-overlay { position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: rgba(255, 255, 255, 0.95); z-index: 2000; display: none; flex-direction: column; align-items: center; justify-content: center; }
.animate-fade { animation: fadeIn 0.4s ease-in-out; }
@keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
input[type=range] { cursor: pointer; }
