<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Studio Pro</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <link rel="stylesheet" href="style.css">
</head>
<body>

<div class="d-flex w-100 h-100 overflow-hidden">
    
    <div id="sidebar-icons" class="d-flex flex-column align-items-center py-3 border-end bg-dark text-white">
        <div class="mb-4 fs-4 fw-bold text-primary" onclick="goHome()" style="cursor: pointer;">
            <i class="bi bi-camera-fill"></i>
        </div>
        <div class="nav flex-column w-100 text-center gap-2">
            <div class="nav-item-icon active" id="nav-id-photo" onclick="switchFeature('id-photo')" title="證件照"><i class="bi bi-person-badge-fill"></i><span class="small d-block">證件照</span></div>
            <div class="nav-item-icon" id="nav-job-photo" onclick="switchFeature('job-photo')" title="求職照"><i class="bi bi-briefcase-fill"></i><span class="small d-block">求職照</span></div>
            <div class="nav-item-icon" id="nav-grad-photo" onclick="switchFeature('grad-photo')" title="畢業照"><i class="bi bi-mortarboard-fill"></i><span class="small d-block">畢業照</span></div>
            <div class="nav-item-icon" id="nav-beauty" onclick="switchFeature('beauty')" title="美顏"><i class="bi bi-magic"></i><span class="small d-block">美顏</span></div>
            <div class="nav-item-icon" id="nav-restore" onclick="switchFeature('restore')" title="老圖翻新"><i class="bi bi-hourglass-split"></i><span class="small d-block">翻新</span></div>
        </div>
        <div class="mt-auto mb-3 nav-item-icon text-danger" onclick="location.reload()" title="重置"><i class="bi bi-power"></i></div>
    </div>

    <div id="sidebar-panels" class="bg-white border-end position-relative">
        <div id="panel-id-photo" class="feature-panel h-100 p-4 overflow-auto">
            <h4 class="fw-bold mb-4">證件照製作</h4>
            <div id="upload-section">
                <div class="upload-btn-wrapper mb-4">
                    <input type="file" id="fileInput" accept="image/*" hidden onchange="handleFileUpload(this)">
                    <button class="btn btn-primary w-100 py-3 shadow-sm fw-bold" onclick="document.getElementById('fileInput').click()"><i class="bi bi-cloud-upload me-2"></i> 上傳照片</button>
                    <div class="text-center mt-2 small text-muted">支援 JPG, PNG</div>
                </div>
                <div id="uploaded-status" class="d-none mb-3 d-flex justify-content-between align-items-center">
                    <span class="text-success fw-bold"><i class="bi bi-check-circle-fill"></i> 照片已載入</span>
                    <a href="#" class="text-decoration-none small" onclick="resetUpload()">重選照片</a>
                </div>
            </div>
            <hr class="my-3 text-secondary opacity-25">
            <div id="specs-section">
                <label class="fw-bold text-muted small mb-2 d-block">選擇用途 / 規格</label>
                <div id="specs-container" class="vstack gap-2 mb-3"></div>
                <div class="spec-card p-2 border rounded text-center mb-3" id="spec-custom" onclick="toggleCustom()"><i class="bi bi-pencil-square"></i> 自訂尺寸</div>
                <div id="custom-inputs" class="d-none row g-1 mb-3">
                    <div class="col"><input type="number" id="custom-w" class="form-control form-control-sm" placeholder="寬mm" oninput="updateCustom()"></div>
                    <div class="col"><input type="number" id="custom-h" class="form-control form-control-sm" placeholder="高mm" oninput="updateCustom()"></div>
                </div>
                <button id="btn-process" class="btn btn-primary w-100 py-2 fw-bold shadow-sm d-none" onclick="processImage()"><i class="bi bi-lightning-charge-fill"></i> 開始 AI 製作</button>
            </div>
            <div id="result-section" class="d-none animate-fade mt-4">
                <div class="d-flex gap-2 mb-3">
                    <div onclick="selectResult('white')" class="result-btn flex-fill p-2 border rounded text-center active" id="res-white"><small class="fw-bold d-block mb-1">白底</small><img id="img-white" class="img-fluid rounded" style="max-height: 60px;"></div>
                    <div onclick="selectResult('blue')" class="result-btn flex-fill p-2 border rounded text-center" id="res-blue"><small class="fw-bold d-block mb-1">藍底</small><img id="img-blue" class="img-fluid rounded" style="max-height: 60px;"></div>
                </div>
                <div class="vstack gap-2">
                    <button class="btn btn-outline-success w-100" onclick="runCheck()"><i class="bi bi-shield-check"></i> 合規檢查</button>
                    <button class="btn btn-success w-100" onclick="downloadImage()"><i class="bi bi-download"></i> 下載高清圖</button>
                    <button class="btn btn-dark w-100" onclick="generateLayout()"><i class="bi bi-grid-3x3"></i> 下載 4x6 排版</button>
                    <button class="btn btn-outline-primary w-100" onclick="toggleEmailInput()"><i class="bi bi-envelope"></i> 寄到信箱</button>
                </div>
                <div id="email-group" class="d-none mt-2 p-2 bg-light rounded border">
                    <div class="input-group input-group-sm">
                        <input type="email" id="user-email" class="form-control" placeholder="Email"><button class="btn btn-primary" onclick="sendEmail()">發送</button>
                    </div>
                </div>
            </div>
        </div>
        <div id="panel-job-photo" class="feature-panel d-none p-4"><h4 class="fw-bold mb-4">職場求職照</h4><div class="alert alert-info small">請從右側儀表板了解詳情。</div></div>
        <div id="panel-grad-photo" class="feature-panel d-none p-4"><h4 class="fw-bold mb-4">畢業學士照</h4><div class="alert alert-info small">請從右側儀表板了解詳情。</div></div>
        <div id="panel-beauty" class="feature-panel d-none p-4"><h4 class="fw-bold mb-4">智能美顏</h4><div class="alert alert-info small">功能開發中。</div></div>
        <div id="panel-restore" class="feature-panel d-none p-4"><h4 class="fw-bold mb-4">老圖翻新</h4><div class="alert alert-info small">功能開發中。</div></div>
    </div>

    <div id="main-content" class="flex-grow-1 bg-light position-relative overflow-hidden"> <div id="dashboard-area" class="container py-5 h-100 d-flex flex-column justify-content-center overflow-auto">
            <div class="text-center mb-5"><h1 class="fw-bold text-dark">AI 影像工作室 Pro</h1><p class="text-muted fs-5">請選擇您要進行的影像處理任務</p></div>
            <div class="row g-4 justify-content-center">
                <div class="col-md-4 col-lg-3"><div class="card feature-card h-100 border-0 shadow-sm" onclick="switchFeature('id-photo')"><div class="card-body text-center py-4"><div class="icon-circle bg-primary text-white mb-3"><i class="bi bi-person-badge-fill"></i></div><h5 class="card-title fw-bold">證件照製作</h5><p class="card-text text-muted small">支援護照、身分證、駕照等自動裁切與去背。</p></div></div></div>
                <div class="col-md-4 col-lg-3"><div class="card feature-card h-100 border-0 shadow-sm" onclick="switchFeature('job-photo')"><div class="card-body text-center py-4"><div class="icon-circle bg-success text-white mb-3"><i class="bi bi-briefcase-fill"></i></div><h5 class="card-title fw-bold">職場求職照</h5><p class="card-text text-muted small">AI 智慧換裝，一鍵生成專業西裝形象照。</p></div></div></div>
                <div class="col-md-4 col-lg-3"><div class="card feature-card h-100 border-0 shadow-sm" onclick="switchFeature('grad-photo')"><div class="card-body text-center py-4"><div class="icon-circle bg-warning text-white mb-3"><i class="bi bi-mortarboard-fill"></i></div><h5 class="card-title fw-bold">畢業學士照</h5><p class="card-text text-muted small">即使沒拍畢業照，也能生成學士/碩士服照片。</p></div></div></div>
            </div>
        </div>

        <div id="intro-area" class="d-none container py-5 h-100 align-items-center justify-content-center text-center"><div id="intro-content" class="p-5 bg-white rounded shadow-sm" style="max-width: 600px;"><i id="intro-icon" class="bi bi-camera fs-1 text-primary"></i><h2 id="intro-title" class="mt-3 fw-bold">功能標題</h2><p id="intro-desc" class="text-muted my-4">功能說明文案...</p><div class="alert alert-light border">⬅️ 請從左側面板上傳照片以開始</div></div></div>

        <div id="workspace-area" class="d-none w-100 h-100 position-relative d-flex align-items-start justify-content-center pt-5 overflow-auto" style="background-color: #e9ecef;">
            <div class="loading-overlay" id="loading"><div class="spinner-border text-primary" role="status"></div><div class="mt-2 fw-bold text-dark">處理中...</div></div>

            <div class="image-wrapper shadow-lg" style="position: relative; width: fit-content; transition: transform 0.1s ease-out;">
                <img id="previewImg" src="" class="d-none img-fluid rounded" style="display: block; max-height: 75vh;">
                <div id="cropMask" class="crop-mask d-none"><div class="mask-label" id="maskLabel"></div></div>
            </div>

            <div id="zoom-toolbar" class="position-absolute bottom-0 start-50 translate-middle-x mb-4 bg-white p-2 rounded-pill shadow-sm border d-flex align-items-center gap-2 px-3">
                <i class="bi bi-zoom-out text-muted"></i>
                <input type="range" class="form-range" id="zoomRange" min="0.5" max="2.5" step="0.1" value="1" style="width: 150px;" oninput="setZoom(this.value)">
                <i class="bi bi-zoom-in text-muted"></i>
                <span class="badge bg-light text-dark border ms-1" id="zoomValue">100%</span>
                <button class="btn btn-sm btn-link text-decoration-none" onclick="setZoom(1.0); document.getElementById('zoomRange').value=1;">重置</button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="checkModal" tabindex="-1" aria-hidden="true"><div class="modal-dialog modal-dialog-centered"><div class="modal-content"><div class="modal-header bg-primary text-white"><h5 class="modal-title">AI 合規檢查</h5><button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button></div><div class="modal-body"><div id="check-results-list" class="list-group"></div></div></div></div></div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script type="module" src="main.js"></script>
</body>
</html>
